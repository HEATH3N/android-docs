<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Query Map Features | Android Documentation</title><meta class="swiftype" name="type" data-type="enum" content="Android Documentation"/><meta class="swiftype" name="title" data-type="string" content="Query Map Features | Android Documentation"/><link href="https://api.mapbox.com/mapbox-assembly/v0.12.0/assembly.min.css" rel="stylesheet"/><script async="" defer="" src="https://api.mapbox.com/mapbox-assembly/v0.12.0/assembly.js"></script><link href="https://api.mapbox.com/mapbox-assembly/mapbox-addon/v0.10.0/assembly.min.css" rel="stylesheet"/><script src="https://api.mapbox.com/mapbox-assembly/mapbox-addon/v0.10.0/assembly.js"></script><link rel="stylesheet" href="stylesheet.css" type="text/css"/><style>.border--3{border-width:3px!important}.bg-green{background-color:#8cca44!important}.icon-android-green svg{color:#8cca44}.bright-blue-color{color:#0082ff}.bright-blue-color-on-hover:hover{color:#0082ff!important}.border--bright-blue-color{border-color:#273d56}.border--gray-less-faint{border-color:#e8ebee!important}.bright-blue-color-on-hover-anchor a:hover{color:#0082ff}.hmax130 img{max-height:130px}.wmax260{max-width:260px}.text-decoration-none{text-decoration:none!important}.unstyled-list li{list-style-type:none!important}.overflow-y{overflow-y:auto}.t48{top:48px}.b0{bottom:0}.txt-ms{font-size:13px!important;line-height:18px}td,th{text-align:left!important;padding:4px!important;font-size:12px!important}th{background-color:#e8ebee}code,pre,td{font-weight:400!important;font-size:12px!important}.limiter{padding-left:24px;padding-right:24px;width:100%}@media (min-width:1200px){.limiter{padding-left:12.5%!important;padding-right:12.5%!important}}.prose h1,h2,h3,h4,h5,h6{font-weight:400!important}@media (min-width:440px){.note-card{margin-top:-12px;width:240px;margin-left:24px;padding-bottom:0!important}}.note-card{padding-bottom:24px}code{font-weight:400}code,pre{font-family:Fira Mono Medium,Monaco,monospace!important}code,pre{font-size:12px!important;word-break:normal!important}pre{font-weight:700;background-color:#232323!important}.doc-ul>.doc-ul-item:before{content:"";width:8px;height:8px;border-radius:2px;border:1px solid #1f3349;opacity:.4;position:absolute;margin:9px 0 0 -20px}.doc-ol{counter-reset:listItem}.doc-ol>.doc-ol-item{margin:3px 0}ol li{list-style-type:none}ol li:before{counter-increment:listItem;content:counter(listItem);font-size:12px;border-radius:3px;padding:1px 6px;border:1px solid #c6d2e1;margin-right:12px}.hljs{color:#a9b7c6;background:#232323;display:block;overflow-x:auto;padding:.5em}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#56b881}.hljs-comment,.hljs-quote{color:gray}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#56b881}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><div id="react-mount"><div class="grid" data-reactroot="" data-reactid="1" data-react-checksum="244924589"><div class="z1 h48 flex-parent--center-main flex-parent w-full border-b border-t bg-white border--gray-less-faint fixed" data-reactid="2"><div class="wmax1200 w-full pl24 pr24 flex-parent--space-between-main flex-parent" data-reactid="3"><div class="flex-child col col--6 inline-block" data-reactid="4"><div class="txt-s py12 bg-transparent btn px0 color-gray-light" data-reactid="5"><strong data-reactid="6">Platform</strong></div><div style="display:inline-block;" data-reactid="7"><button class="txt-s py12 border--bright-blue-color bright-blue-color-on-hover bg-transparent btn flex-parent flex-parent--center-cross color-gray-dark" data-reactid="8"><strong data-reactid="9">Android</strong><svg class="icon" data-reactid="10"><use xlink:href="#icon-chevron-down" data-reactid="11"></use></svg></button></div><div class="txt-s py12 bg-transparent btn px0 color-gray-light" data-reactid="12"><strong data-reactid="13">Product</strong></div><div style="display:inline-block;" data-reactid="14"><button class="txt-s py12 border--bright-blue-color bright-blue-color-on-hover bg-transparent btn flex-parent flex-parent--center-cross color-gray-dark" data-reactid="15"><strong data-reactid="16">Map SDK</strong><svg class="icon" data-reactid="17"><use xlink:href="#icon-chevron-down" data-reactid="18"></use></svg></button></div></div><div class="flex-child col col--6 flex-parent flex-parent--end-main" data-reactid="19"><a class="py12 transition mobile-right-nav unround btn color-gray-dark border--bright-blue-color bright-blue-color-on-hover bg-transparent txt-s  border-b border--3" href="/android-docs/map-sdk/overview/" data-reactid="20">Overview</a><a class="py12 transition mobile-right-nav unround btn color-gray-dark border--bright-blue-color bright-blue-color-on-hover bg-transparent txt-s  " href="/android-docs/map-sdk/examples/" data-reactid="21">Examples</a><a class="py12 transition mobile-right-nav unround btn color-gray-dark border--bright-blue-color bright-blue-color-on-hover bg-transparent txt-s  " href="/android-docs/map-sdk/tutorials/" data-reactid="22">Tutorials</a></div></div></div><div class="scroll-styled flex-parent--center-main flex-parent limiter pb96 pl24 pr24 pt24 overflow-y t48 b0 fixed flex-child" data-reactid="23"><div class="flex-parent--space-between-main flex-parent" data-reactid="24"><div class="col col--2 pt42 pr18 pb18 flex-child--no-shrink fixed color-gray-dark unstyled-list scroll-styled" data-reactid="25"><div data-reactid="26"><li class="txt-bold txt-fancy" data-reactid="27"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/" data-reactid="28">Map SDK</a></li><!-- react-text: 29 --><!-- /react-text --></div><div data-reactid="30"><li class="txt-bold txt-fancy" data-reactid="31"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/styling-map/" data-reactid="32">Styling the map</a></li><!-- react-text: 33 --><!-- /react-text --></div><div data-reactid="34"><li class="txt-bold txt-fancy" data-reactid="35"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/annotations/" data-reactid="36">Annotations</a></li><!-- react-text: 37 --><!-- /react-text --></div><div data-reactid="38"><li class="txt-bold txt-fancy" data-reactid="39"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/events/" data-reactid="40">Events</a></li><!-- react-text: 41 --><!-- /react-text --></div><div data-reactid="42"><li class="txt-bold txt-fancy" data-reactid="43"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/offline/" data-reactid="44">Offline</a></li><!-- react-text: 45 --><!-- /react-text --></div><div data-reactid="46"><li class="txt-bold txt-fancy" data-reactid="47"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/query-map/" data-reactid="48"><div class="bright-blue-color" data-reactid="49">Query Map Features</div></a></li><div class="ml6 pt6" data-reactid="50"><ul class="txt-s inline-block mb12 bright-blue-color-on-hover-anchor">
<li>
<ul>
<li><a href="#query-rendered-features">Query rendered features</a></li>
<li><a href="#query-source-features">Query source features</a></li>
</ul>
</li>
</ul>
</div></div><div data-reactid="51"><li class="txt-bold txt-fancy" data-reactid="52"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/map-sdk/overview/runtime-styling/" data-reactid="53">Runtime Styling</a></li><!-- react-text: 54 --><!-- /react-text --></div><!-- react-text: 55 --><!-- /react-text --><div class="flex-parent wmin180 pb12 flex-parent--column" data-reactid="56"><a href="/android-docs/api/map-sdk/5.1.0/index.html" class="txt-fancy bright-blue-color-on-hover" data-reactid="57">API Reference</a></div><!-- react-text: 58 --><!-- /react-text --></div><div data-reactid="59"><div class="prose color-gray-dark" data-reactid="60"><div class="content col--9 col col--offl3" data-reactid="61"><div class="pt12 doc-ul doc-ol pb96 wmax1200 doc-ol-item" data-reactid="62"><div class="markdown" data-reactid="63"><div data-reactid="64"><h1 id="query-map-features"><a class="markdownIt-Anchor" href="#query-map-features"></a> Query Map Features</h1>
<p>The Map SDK gives you the tools to query the map layers to get a list of GeoJSON features which hold valuable information used for rendering the map. An example usage of this can be to query where the user clicks/taps the map and determine if they selected a POI displaying on the map. You can then move through the provided GeoJSON Feature to get the properties which holds the POI name as a <code>String</code>. It’s important to consider that querying a map won’t always return the information you are looking for, therefore, it is possible to receive a Feature list with 0 items in it.</p>
<div class="fr flex-parent">
  <a href="https://github.com/mapbox/mapbox-android-demo/blob/master/MapboxAndroidDemo/src/main/java/com/mapbox/mapboxandroiddemo/examples/query/QueryFeatureActivity.java" class="text-decoration-none flex-child--no-shrink mt6 color-blue-on-hover note-card flex-child-mxl">
    <div class="border round wmax360 border--gray-light flex-parent">
      <div class="flex-child p12">
        <div class="txt-s txt-bold">
          Query at point
          <span class="txt-xs txt-bold align-middle px6 color-blue round bg-blue-faint">EXAMPLE</span>
        </div>
        <div class="txt-s mt3 mb0 color-gray">
          Query the rendered map to get the properties at a specific location.
        </div>
      </div>
      <div class="flex-child flex-child--no-shrink w18 fr border-l border--gray-light flex-parent flex-parent--center-cross">
        <svg class='flex-child align-middle icon--l'><use xlink:href='#icon-chevron-right'/></svg>
      </div>
    </div>
  </a>
</div>
<p>Querying the map can be done considering a specific point on the screen or by first constructing a bounding box and receiving all the features found within that region. Aside from layers, it is also possible to query the source for specific information matching your query regardless if the items actually being displayed on the map.</p>
<p>Since the features come from tiled vector data or GeoJSON data that is converted to tiles internally, feature geometries may be split or duplicated across tile boundaries and, as a result, features may appear multiple times in query results. For example, suppose there is a highway running through the bounding rectangle of a query. The results of the query will be those parts of the highway that lie within the map tiles covering the bounding rectangle, even if the highway extends into other tiles, and the portion of the highway within each map tile will be returned as a separate feature. Similarly, a point feature near a tile boundary may appear in multiple tiles due to tile buffering.</p>
<h3 id="query-rendered-features"><a class="markdownIt-Anchor" href="#query-rendered-features"></a> Query rendered features</h3>
<p>A common usage for querying the map is to acquire information at a specific position the user is looking at. The point must be viewable inside the user devices viewport and fully rendered before you can access any information. Querying the map only accepts a screen pixel value instead of LatLng so in many cases you’ll need to convert beforehand. In the snippet below, the maps clicked on which provides a LatLng we use to query the map and get the properties at that location.</p>
<pre class="hljs"><code><span class="hljs-meta">@Override</span>
<span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onMapClick</span><span class="hljs-params">(@NonNull LatLng point)</span> </span>{

  <span class="hljs-comment">// Convert LatLng coordinates to screen pixel and only query the rendered features.</span>
  <span class="hljs-keyword">final</span> PointF pixel = mapboxMap.getProjection().toScreenLocation(point);
  List&lt;Feature&gt; features = mapboxMap.queryRenderedFeatures(pixel);

  <span class="hljs-comment">// Get the first feature within the list if one exist</span>
  <span class="hljs-keyword">if</span> (features.size() &gt; <span class="hljs-number">0</span>) {
    Feature feature = features.get(<span class="hljs-number">0</span>);

    <span class="hljs-comment">// Ensure the feature has properties defined</span>
    <span class="hljs-keyword">if</span> (feature.getProperties() != <span class="hljs-keyword">null</span>) {
      <span class="hljs-keyword">for</span> (Map.Entry&lt;String, JsonElement&gt; entry : feature.getProperties().entrySet()) {
        <span class="hljs-comment">// Log all the properties</span>
        Log.d(TAG, String.format(<span class="hljs-string">"%s = %s"</span>, entry.getKey(), entry.getValue()));
      }
    }
  }
}
</code></pre>
<h4 id="query-features-inside-a-bounding-box"><a class="markdownIt-Anchor" href="#query-features-inside-a-bounding-box"></a> Query features inside a bounding box</h4>
<div class="fr flex-parent">
  <a href="https://github.com/mapbox/mapbox-android-demo/blob/master/MapboxAndroidDemo/src/main/java/com/mapbox/mapboxandroiddemo/examples/query/FeatureCountActivity.java" class="text-decoration-none flex-child--no-shrink mt6 color-blue-on-hover note-card flex-child-mxl">
    <div class="border round wmax360 border--gray-light flex-parent">
      <div class="flex-child p12">
        <div class="txt-s txt-bold">
          Query region
          <span class="txt-xs txt-bold align-middle px6 color-blue round bg-blue-faint">EXAMPLE</span>
        </div>
        <div class="txt-s mt3 mb0 color-gray">
          Query the rendered map to get the features found inside an Android view.
        </div>
      </div>
      <div class="flex-child flex-child--no-shrink w18 fr border-l border--gray-light flex-parent flex-parent--center-cross">
        <svg class='flex-child align-middle icon--l'><use xlink:href='#icon-chevron-right'/></svg>
      </div>
    </div>
  </a>
</div>
<p>In addition to querying a specific point on the map, it is also possible to pass in a bounding box by passing in a <code>RectF</code> object. This can either come from a Android view currently displayed to the user on top of the map, or 4 coordinates that are currently showing within the viewport. The snippet below shows how to take four coordinates, convert them into <code>PointF</code> objects, adding them into a new <code>RectF</code> and finally, passing the “bounding box” into <code>queryRenderedFeatures()</code>.</p>
<pre class="hljs"><code>RectF rectF = <span class="hljs-keyword">new</span> RectF(
  mapboxMap.getProjection().toScreenLocation(&lt;left coordinate&gt;),
  mapboxMap.getProjection().toScreenLocation(&lt;top coordinate&gt;),
  mapboxMap.getProjection().toScreenLocation(&lt;right coordinate&gt;),
  mapboxMap.getProjection().toScreenLocation(&lt;bottom coordinate&gt;)
);
mapboxMap.queryRenderedFeatures(rectF);
</code></pre>
<h3 id="query-source-features"><a class="markdownIt-Anchor" href="#query-source-features"></a> Query source features</h3>
<p>In contrast to <code>mapboxMap.queryRenderedFeatures()</code>, using <code>querySourceFeatures</code> returns all features matching the query parameters, whether or not they are rendered by the current style (i.e. visible). The domain of the query includes all currently-loaded vector tiles and GeoJSON source tiles: this function does not check tiles outside the currently visible viewport.</p>
<p>Since features come from tiled vector data or GeoJSON data that is converted to tiles internally, feature geometries may be split or duplicated across tile boundaries just like if you were going to queryRenderedFeatures(). To query a source, you must pass in the query parameters as a set of <code>Filters</code> and only the features that satisfy the statement will be added to the returning list of features. For example, in the snippet below, the map style contains a GeoJSON source called population-source which contains a property for each feature defining it’s population. When we query we are only wanting features which have a greater population than 100000.</p>
<pre class="hljs"><code>GeoJsonSource source = mapboxMap.getSourceAs(<span class="hljs-string">"population-source"</span>);
List&lt;Feature&gt; features = source.querySourceFeatures(Filter.gt(<span class="hljs-string">"population"</span>, <span class="hljs-string">"100000"</span>))
</code></pre>
</div></div></div></div></div></div></div></div></div></div><script src="/android-docs/bundle.js?t=1500485449854"></script></body></html>