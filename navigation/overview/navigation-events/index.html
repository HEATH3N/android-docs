<!DOCTYPE html>
 <html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Navigation Events | Android Documentation</title><meta name="type" data-type="enum" content="Android Documentation"/><meta name="title" data-type="string" content="Navigation Events | Android Documentation"/><link href="https://api.mapbox.com/mapbox-assembly/v0.12.0/assembly.min.css" rel="stylesheet"/><script async="" defer="" src="https://api.mapbox.com/mapbox-assembly/v0.12.0/assembly.js"></script><link href="https://api.mapbox.com/mapbox-assembly/mapbox-addon/v0.10.0/assembly.min.css" rel="stylesheet"/><script src="https://api.mapbox.com/mapbox-assembly/mapbox-addon/v0.10.0/assembly.js"></script><link rel="stylesheet" href="stylesheet.css" type="text/css"/><style>.border--3{border-width:3px!important}.bg-green{background-color:#8cca44!important}.icon-android-green svg{color:#8cca44}.bright-blue-color{color:#0082ff}.bright-blue-color-on-hover:hover{color:#0082ff!important}.border--bright-blue-color{border-color:#273d56}.border--gray-less-faint{border-color:#e8ebee!important}.bright-blue-color-on-hover-anchor a:hover{color:#0082ff}.hmax130 img{max-height:130px}.wmax260{max-width:260px}.text-decoration-none{text-decoration:none!important}.unstyled-list li{list-style-type:none!important}.overflow-y{overflow-y:auto}.t48{top:48px}.b0{bottom:0}.txt-ms{font-size:13px!important;line-height:18px}.limiter{padding-left:24px;padding-right:24px;width:100%}@media (min-width:1200px){.limiter{padding-left:12.5%!important;padding-right:12.5%!important}}.prose h1,h2,h3,h4,h5,h6{font-weight:400!important}@media (min-width:440px){.note-card{margin-top:-12px;width:240px;margin-left:24px;padding-bottom:24px}}code,pre{font-family:Fira Mono Medium,Monaco,monospace!important;font-weight:700!important;font-size:12px!important;word-break:normal!important}pre{background-color:#232323!important}.doc-ul>.doc-ul-item:before{content:"";width:8px;height:8px;border-radius:2px;border:1px solid #1f3349;opacity:.4;position:absolute;margin:9px 0 0 -20px}.doc-ol{counter-reset:listItem}.doc-ol>.doc-ol-item{margin:3px 0}ol li{list-style-type:none}ol li:before{counter-increment:listItem;content:counter(listItem);font-size:12px;border-radius:3px;padding:1px 6px;border:1px solid #c6d2e1;margin-right:12px}.hljs{color:#a9b7c6;background:#232323;display:block;overflow-x:auto;padding:.5em}.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#6897bb}.hljs-deletion,.hljs-keyword,.hljs-selector-tag{color:#cc7832}.hljs-link,.hljs-template-variable,.hljs-variable{color:#56b881}.hljs-comment,.hljs-quote{color:gray}.hljs-meta{color:#bbb529}.hljs-addition,.hljs-attribute,.hljs-string{color:#56b881}.hljs-section,.hljs-title,.hljs-type{color:#ffc66d}.hljs-name,.hljs-selector-class,.hljs-selector-id{color:#e8bf6a}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}</style></head><body><div id="react-mount"><div class="grid" data-reactroot="" data-reactid="1" data-react-checksum="1442765886"><div class="z1 min48 flex-parent--center-main flex-parent w-full border-b border-t bg-white border--gray-less-faint fixed" data-reactid="2"><div class="wmax1200 w-full pl24 pr24 flex-parent--space-between-main flex-parent" data-reactid="3"><div class="flex-child col col--6 inline-block" data-reactid="4"><div class="txt-s py12 bg-transparent btn px0 color-gray-light" data-reactid="5"><strong data-reactid="6">Platform</strong></div><div class="txt-s py12 bg-transparent btn  color-gray-dark" data-reactid="7"><strong data-reactid="8">Android</strong></div><div class="txt-s py12 bg-transparent btn px0 color-gray-light" data-reactid="9"><strong data-reactid="10">Product</strong></div><div style="display:inline-block;" data-reactid="11"><button class="txt-s py12 border--bright-blue-color bright-blue-color-on-hover bg-transparent btn flex-parent flex-parent--center-cross color-gray-dark" data-reactid="12"><strong data-reactid="13">Navigation SDK</strong><svg class="icon" data-reactid="14"><use xlink:href="#icon-chevron-down" data-reactid="15"></use></svg></button></div></div><div class="flex-child col col--6 flex-parent flex-parent--end-main" data-reactid="16"><a class="py12 transition mobile-right-nav unround btn color-gray-dark border--bright-blue-color bright-blue-color-on-hover bg-transparent txt-s  border-b border--3" href="/android-docs/navigation/overview/" data-reactid="17">Overview</a><!-- react-text: 18 --><!-- /react-text --><!-- react-text: 19 --><!-- /react-text --></div></div></div><div class="scroll-styled flex-parent--center-main flex-parent limiter pb96 pl24 pr24 pt24 overflow-y t48 b0 fixed flex-child" data-reactid="20"><div class="flex-parent--space-between-main flex-parent" data-reactid="21"><div class="col col--2 pt42 pr18 pb18 flex-child--no-shrink fixed color-gray-dark unstyled-list scroll-styled" data-reactid="22"><div data-reactid="23"><li class="txt-bold txt-fancy" data-reactid="24"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/navigation/overview/" data-reactid="25">Navigation SDK</a></li><!-- react-text: 26 --><!-- /react-text --></div><div data-reactid="27"><li class="txt-bold txt-fancy" data-reactid="28"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/navigation/overview/navigation-events/" data-reactid="29"><div class="bright-blue-color" data-reactid="30">Navigation Events</div></a></li><div class="ml6 pt6" data-reactid="31"><ul class="txt-s inline-block mb12 bright-blue-color-on-hover-anchor">
<li>
<ul>
<li><a href="#navigationrunning">NavigationRunning</a></li>
<li><a href="#alertlevelchange">AlertLevelChange</a></li>
<li><a href="#onprogresschange">OnProgressChange</a></li>
<li><a href="#useroffroute">UserOffRoute</a></li>
</ul>
</li>
</ul>
</div></div><div data-reactid="32"><li class="txt-bold txt-fancy" data-reactid="33"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/navigation/overview/navigation-options/" data-reactid="34">Navigation Options</a></li><!-- react-text: 35 --><!-- /react-text --></div><div data-reactid="36"><li class="txt-bold txt-fancy" data-reactid="37"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/navigation/overview/route-progress/" data-reactid="38">Route Progress Object</a></li><!-- react-text: 39 --><!-- /react-text --></div><div data-reactid="40"><li class="txt-bold txt-fancy" data-reactid="41"><a class="bright-blue-color-on-hover text-decoration-none" href="/android-docs/api/navigation-sdk/0.2.0/index.html" data-reactid="42">API Reference</a></li><!-- react-text: 43 --><!-- /react-text --></div><!-- react-text: 44 --><!-- /react-text --></div><div data-reactid="45"><div class="prose color-gray-dark" data-reactid="46"><div class="content col--9 col col--offl3" data-reactid="47"><div class="pt12 doc-ul doc-ol pb96 wmax1200 doc-ol-item" data-reactid="48"><div class="markdown" data-reactid="49"><div data-reactid="50"><h1 id="navigation-events"><a class="markdownIt-Anchor" href="#navigation-events"></a> Navigation Events</h1>
<p>Chances are, if you are using the Navigation SDK, you’ll want to listen in to events such as when the user makes progress along the route or when the user goes off-route. Listeners help you provide the user with instructions at the proper times. At the bare minimum, it is strongly encouraged to use the <code>OnProgressChange</code> listener, which is called every time the user’s locations updated.</p>
<h3 id="navigationrunning"><a class="markdownIt-Anchor" href="#navigationrunning"></a> NavigationRunning</h3>
<p>The event callback is handy for being notified when the navigation session has started, the user has canceled the session, or the user has arrived at their final destination. From this information, you can decide when to show navigation notifications, know when it’s safe to stop requesting user location updates, and much more.</p>
<pre class="hljs"><code>navigation.addNavigationEventListener(<span class="hljs-keyword">new</span> NavigationEventListener() {
  <span class="hljs-meta">@Override</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onRunning</span><span class="hljs-params">(<span class="hljs-keyword">boolean</span> running)</span> </span>{

  }
});
</code></pre>
<h3 id="alertlevelchange"><a class="markdownIt-Anchor" href="#alertlevelchange"></a> AlertLevelChange</h3>
<p>Listening in to the alertLevelChange is useful for correctly getting the timing of user notifications while the user is traversing along the route. The listener only notifies you when the user’s reached a particular point along the current step that they are on. The alert thresholds can be adjusted using the <code>MapboxNavigationOptions</code> while developing and are based on time (in seconds) until the user reaches the next maneuver.</p>
<table>
<thead>
<tr>
<th>Alert level</th>
<th style="text-align:center">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DEPART_ALERT_LEVEL</code></td>
<td style="text-align:center">Occurs when the user first leaves the origin and shouldn’t be invoked again for the rest of the navigation session.</td>
</tr>
<tr>
<td><code>LOW_ALERT_LEVEL</code></td>
<td style="text-align:center">Invoked right after the user does a maneuver and they have started traversing along a new step.</td>
</tr>
<tr>
<td><code>MEDIUM_ALERT_LEVEL</code></td>
<td style="text-align:center">Occurs when the user’s x seconds away from their next maneuver. By default, this happens 70 seconds from the next maneuver.</td>
</tr>
<tr>
<td><code>HIGH_ALERT_LEVEL</code></td>
<td style="text-align:center">Useful to know when the user’s about to do the next maneuver on the route. By default, this happens 15 seconds from the next maneuver.</td>
</tr>
<tr>
<td><code>ARRIVE_ALERT_LEVEL</code></td>
<td style="text-align:center">Occurs when the user has performed the last maneuver along the route and reached their final destination.</td>
</tr>
<tr>
<td><code>NONE_ALERT_LEVEL</code></td>
<td style="text-align:center">Used as the starting alert when a navigation session has started.</td>
</tr>
</tbody>
</table>
<pre class="hljs"><code>navigation.addAlertLevelChangeListener(<span class="hljs-keyword">new</span> AlertLevelChangeListener() {
  <span class="hljs-meta">@Override</span>
  <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onAlertLevelChange</span><span class="hljs-params">(<span class="hljs-keyword">int</span> alertLevel, RouteProgress routeProgress)</span> </span>{
    <span class="hljs-keyword">switch</span> (alertLevel) {
      <span class="hljs-keyword">case</span> HIGH_ALERT_LEVEL:
        Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"HIGH"</span>, Toast.LENGTH_LONG).show();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> MEDIUM_ALERT_LEVEL:
        Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"MEDIUM"</span>, Toast.LENGTH_LONG).show();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> LOW_ALERT_LEVEL:
        Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"LOW"</span>, Toast.LENGTH_LONG).show();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> ARRIVE_ALERT_LEVEL:
        Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"ARRIVE"</span>, Toast.LENGTH_LONG).show();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> NONE_ALERT_LEVEL:
        Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"NONE"</span>, Toast.LENGTH_LONG).show();
        <span class="hljs-keyword">break</span>;
      <span class="hljs-keyword">case</span> DEPART_ALERT_LEVEL:
        Toast.makeText(MainActivity.<span class="hljs-keyword">this</span>, <span class="hljs-string">"DEPART"</span>, Toast.LENGTH_LONG).show();
        <span class="hljs-keyword">break</span>;
    }
  }
});
</code></pre>
<h3 id="onprogresschange"><a class="markdownIt-Anchor" href="#onprogresschange"></a> OnProgressChange</h3>
<p>Like tracking user location changes, this listener’s invoked every time the user’s location changes but provides an updated RouteProgress object. It is strongly encouraged to use this listener since you can typically refresh most of your application’s user interface. An example of this will be if you are displaying the user’s current progress until the user needs to do the next maneuver. Every time this listener’s invoked, you can update your view with the new information from <code>RouteProgress</code>.</p>
<p>Besides receiving information about the route progress, the callback also provides you with the user’s current location which can provide their current speed, bearing, etc. If you have the snap to route enabled, the location object will be updated to give the snapped coordinates.</p>
<pre class="hljs"><code>navigation.addProgressChangeListener(<span class="hljs-keyword">new</span> ProgressChangeListener() {
      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onProgressChange</span><span class="hljs-params">(Location location, RouteProgress routeProgress)</span> </span>{

      }
    });
</code></pre>
<h3 id="useroffroute"><a class="markdownIt-Anchor" href="#useroffroute"></a> UserOffRoute</h3>
<p>During the navigation session, you can listen into the listener which gets invoked once when the user location moves outside the threshold. You can adjust this threshold using the <code>MapboxNavigationOptions</code> object, the default’s 50 meters. Inside the callback, you can alert the user and reroute them if needed using <code>updateRoute()</code>.</p>
<pre class="hljs"><code>navigation.addOffRouteListener(<span class="hljs-keyword">new</span> OffRouteListener() {
      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">userOffRoute</span><span class="hljs-params">(Location location)</span> </span>{
        Position newOrigin = Position.fromCoordinates(location.getLongitude(), location.getLatitude());
    navigation.updateRoute(newOrigin, destination, <span class="hljs-keyword">new</span> Callback&lt;DirectionsResponse&gt;() {
      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onResponse</span><span class="hljs-params">(Call&lt;DirectionsResponse&gt; call, Response&lt;DirectionsResponse&gt; response)</span> </span>{
        <span class="hljs-comment">// Remove the old route and redraw new one here</span>
      }

      <span class="hljs-meta">@Override</span>
      <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">onFailure</span><span class="hljs-params">(Call&lt;DirectionsResponse&gt; call, Throwable throwable)</span> </span>{
        <span class="hljs-comment">// Log any failure that might occur here</span>
      }
    });
  }
});
</code></pre>
</div></div></div></div></div></div></div></div></div></div><script src="/android-docs/bundle.js?t=1496714289311"></script></body></html>